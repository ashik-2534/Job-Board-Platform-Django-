{% extends "base.html" %}
{% load static %}
{% load custom_filters %}

{% block content %}
<div class="container-fluid py-4">
  <div class="row justify-content-center">
    <div class="col-xl-10 col-lg-11">
      
      <!-- Profile Hero Section -->
      <div class="profile-hero-card mb-4">
        <div class="hero-background"></div>
        <div class="hero-content">
          <div class="row align-items-center">
            <div class="col-lg-3 text-center">
              <div class="profile-avatar-wrapper">
                <img src="{{ profile.image.url|default:"{% static 'profile_pics/default.jpg' %}" }}"
                     alt="{{ profile_user.username }}'s profile picture"
                     class="profile-avatar" />
                {% if profile.is_company %}
                  <div class="avatar-badge company-badge">
                    <i class="fas fa-building"></i>
                  </div>
                {% else %}
                  <div class="avatar-badge user-badge">
                    <i class="fas fa-user-tie"></i>
                  </div>
                {% endif %}
              </div>
            </div>
            
            <div class="col-lg-6">
              <div class="profile-info">
                <h1 class="profile-name">
                  {% if profile.is_company %}
                    {{ profile.company_name|default:profile_user.username }}
                  {% else %}
                    {{ profile_user.get_full_name|default:profile_user.username }}
                  {% endif %}
                </h1>
                
                <div class="profile-meta">
                  <span class="meta-item">
                    <i class="fas fa-at"></i>
                    {{ profile_user.username }}
                  </span>
                  <span class="meta-item">
                    <i class="fas fa-envelope"></i>
                    {{ profile_user.email }}
                  </span>
                  {% if profile.phone %}
                    <span class="meta-item">
                      <i class="fas fa-phone"></i>
                      {{ profile.phone }}
                    </span>
                  {% endif %}
                </div>
                
                <div class="role-badge-wrapper">
                  <span class="role-badge {% if profile.is_company %}company-role{% else %}applicant-role{% endif %}">
                    {% if profile.is_company %}
                      <i class="fas fa-building"></i>
                    {% else %}
                      <i class="fas fa-user-graduate"></i>
                    {% endif %}
                    {{ profile.get_role_display }}
                  </span>
                  <span class="join-date">
                    <i class="fas fa-calendar-alt"></i>
                    Member since {{ profile_user.date_joined|date:"F Y" }}
                  </span>
                </div>
              </div>
            </div>
            
            <div class="col-lg-3 text-end">
              {% if is_own_profile %}
                <div class="profile-actions">
                  <a href="{% url 'profile-edit' %}" class="btn btn-primary btn-action">
                    <i class="fas fa-edit"></i>
                    Edit Profile
                  </a>
                  <a href="{% url 'dashboard' %}" class="btn btn-outline-primary btn-action">
                    <i class="fas fa-tachometer-alt"></i>
                    Dashboard
                  </a>
                </div>
              {% endif %}
            </div>
          </div>
        </div>
      </div>

      <!-- Content Grid -->
      <div class="row">
        <!-- Left Column -->
        <div class="col-lg-4">
          
          <!-- About Section -->
          {% if profile.bio %}
          <div class="info-card">
            <div class="card-header">
              <h5><i class="fas fa-user-circle"></i> About</h5>
            </div>
            <div class="card-body">
              <p class="bio-text">{{ profile.bio|linebreaks }}</p>
            </div>
          </div>
          {% endif %}

          <!-- Quick Stats for Companies -->
          {% if profile.is_company %}
          <div class="info-card">
            <div class="card-header">
              <h5><i class="fas fa-chart-bar"></i> Company Stats</h5>
            </div>
            <div class="card-body">
              <div class="stats-grid">
                {% if profile.company_size %}
                <div class="stat-item">
                  <div class="stat-icon company-size">
                    <i class="fas fa-users"></i>
                  </div>
                  <div class="stat-info">
                    <span class="stat-label">Company Size</span>
                    <span class="stat-value">{{ profile.company_size }}</span>
                  </div>
                </div>
                {% endif %}
                {% if profile.industry %}
                <div class="stat-item">
                  <div class="stat-icon industry">
                    <i class="fas fa-industry"></i>
                  </div>
                  <div class="stat-info">
                    <span class="stat-label">Industry</span>
                    <span class="stat-value">{{ profile.industry }}</span>
                  </div>
                </div>
                {% endif %}
              </div>
            </div>
          </div>
          {% endif %}

          <!-- Skills for Applicants -->
          {% if profile.is_applicant and profile.skills %}
          <div class="info-card">
            <div class="card-header">
              <h5><i class="fas fa-code"></i> Skills</h5>
            </div>
            <div class="card-body">
              <div class="skills-container">
                {% for skill in profile.skills|split:"," %}
                  <span class="skill-tag">{{ skill|trim }}</span>
                {% endfor %}
              </div>
            </div>
          </div>
          {% endif %}

        </div>

        <!-- Right Column -->
        <div class="col-lg-8">
          
          {% if profile.is_company %}
          <!-- Company Information -->
          <div class="info-card">
            <div class="card-header">
              <h5><i class="fas fa-building"></i> Company Information</h5>
            </div>
            <div class="card-body">
              {% if profile.company_description %}
                <div class="company-description">
                  <h6>About Our Company</h6>
                  <p>{{ profile.company_description|linebreaks }}</p>
                </div>
              {% endif %}
              
              {% if profile.company_website %}
                <div class="company-link">
                  <h6>Visit Our Website</h6>
                  <a href="{{ profile.company_website }}" target="_blank" class="website-link">
                    <i class="fas fa-external-link-alt"></i>
                    {{ profile.company_website }}
                  </a>
                </div>
              {% endif %}
              
              {% if is_own_profile %}
                <div class="action-buttons">
                  <a href="{% url 'job-create' %}" class="btn btn-success">
                    <i class="fas fa-plus-circle"></i> Post New Job
                  </a>
                  <a href="{% url 'my-posted-jobs' %}" class="btn btn-outline-primary">
                    <i class="fas fa-briefcase"></i> My Posted Jobs
                  </a>
                </div>
              {% endif %}
            </div>
          </div>
          
          {% else %}
          <!-- Applicant Information -->
          <div class="info-card">
            <div class="card-header">
              <h5><i class="fas fa-user-tie"></i> Professional Profile</h5>
            </div>
            <div class="card-body">
              <div class="professional-grid">
                
                <div class="professional-item">
                  <div class="item-icon experience">
                    <i class="fas fa-briefcase"></i>
                  </div>
                  <div class="item-content">
                    <h6>Experience</h6>
                    <p>
                      {% if profile.experience_years %}
                        {{ profile.experience_years }} year{{ profile.experience_years|pluralize }} of experience
                      {% else %}
                        Entry level / No experience
                      {% endif %}
                    </p>
                  </div>
                </div>
                
                {% if profile.education %}
                <div class="professional-item">
                  <div class="item-icon education">
                    <i class="fas fa-graduation-cap"></i>
                  </div>
                  <div class="item-content">
                    <h6>Education</h6>
                    <p>{{ profile.education|truncatewords:30 }}</p>
                  </div>
                </div>
                {% endif %}
                
                {% if profile.resume and is_own_profile %}
                <div class="professional-item">
                  <div class="item-icon resume">
                    <i class="fas fa-file-pdf"></i>
                  </div>
                  <div class="item-content">
                    <h6>Resume</h6>
                    <a href="{{ profile.resume.url }}" class="resume-download" target="_blank">
                      <i class="fas fa-download"></i> Download Resume
                    </a>
                  </div>
                </div>
                {% endif %}
                
              </div>
              
              {% if is_own_profile %}
              <div class="action-buttons">
                <a href="{% url 'job-list' %}" class="btn btn-success">
                  <i class="fas fa-search"></i> Browse Jobs
                </a>
                <a href="{% url 'my-applied-jobs' %}" class="btn btn-outline-primary">
                  <i class="fas fa-file-alt"></i> My Applications
                </a>
              </div>
              {% endif %}
            </div>
          </div>
          {% endif %}

        </div>
      </div>
    </div>
  </div>
</div>

<style>
/* Profile Hero Section */
.profile-hero-card {
  background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
  border-radius: 20px;
  overflow: hidden;
  position: relative;
  box-shadow: 0 10px 40px rgba(0, 0, 0, 0.15);
}

.hero-background {
  position: absolute;
  top: 0;
  left: 0;
  right: 0;
  bottom: 0;
  background: linear-gradient(135deg, rgba(102, 126, 234, 0.9), rgba(118, 75, 162, 0.9));
  backdrop-filter: blur(10px);
}

.hero-content {
  position: relative;
  z-index: 2;
  padding: 2.5rem;
  color: white;
}

/* Profile Avatar */
.profile-avatar-wrapper {
  position: relative;
  display: inline-block;
  margin-bottom: 1rem;
}

.profile-avatar {
  width: 140px;
  height: 140px;
  border-radius: 50%;
  object-fit: cover;
  border: 4px solid rgba(255, 255, 255, 0.3);
  box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
  transition: all 0.3s ease;
}

.profile-avatar:hover {
  transform: scale(1.05);
  box-shadow: 0 12px 40px rgba(0, 0, 0, 0.4);
}

.avatar-badge {
  position: absolute;
  bottom: 5px;
  right: 5px;
  width: 40px;
  height: 40px;
  border-radius: 50%;
  display: flex;
  align-items: center;
  justify-content: center;
  border: 3px solid white;
  box-shadow: 0 4px 12px rgba(0, 0, 0, 0.3);
}

.company-badge {
  background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
}

.user-badge {
  background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%);
}

/* Profile Info */
.profile-info {
  color: white;
}

.profile-name {
  font-size: 2.2rem;
  font-weight: 700;
  margin-bottom: 1rem;
  text-shadow: 0 2px 10px rgba(0, 0, 0, 0.3);
}

.profile-meta {
  display: flex;
  flex-wrap: wrap;
  gap: 1.5rem;
  margin-bottom: 1.5rem;
}

.meta-item {
  display: flex;
  align-items: center;
  gap: 0.5rem;
  font-size: 0.95rem;
  opacity: 0.9;
}

.meta-item i {
  width: 16px;
  text-align: center;
}

.role-badge-wrapper {
  display: flex;
  flex-wrap: wrap;
  gap: 1rem;
  align-items: center;
}

.role-badge {
  padding: 0.6rem 1.2rem;
  border-radius: 25px;
  font-weight: 600;
  font-size: 0.9rem;
  display: flex;
  align-items: center;
  gap: 0.5rem;
  box-shadow: 0 4px 12px rgba(0, 0, 0, 0.2);
}

.company-role {
  background: linear-gradient(135deg, #ff9a9e 0%, #fecfef 100%);
  color: #6b21a8;
}

.applicant-role {
  background: linear-gradient(135deg, #a8edea 0%, #fed6e3 100%);
  color: #065f46;
}

.join-date {
  font-size: 0.85rem;
  opacity: 0.8;
  display: flex;
  align-items: center;
  gap: 0.5rem;
}

/* Profile Actions */
.profile-actions {
  display: flex;
  flex-direction: column;
  gap: 0.75rem;
}

.btn-action {
  border-radius: 25px;
  padding: 0.6rem 1.5rem;
  font-weight: 600;
  transition: all 0.3s ease;
  box-shadow: 0 4px 12px rgba(0, 0, 0, 0.2);
}

.btn-action:hover {
  transform: translateY(-2px);
  box-shadow: 0 6px 20px rgba(0, 0, 0, 0.3);
}

/* Info Cards */
.info-card {
  background: white;
  border-radius: 16px;
  box-shadow: 0 4px 20px rgba(0, 0, 0, 0.08);
  margin-bottom: 1.5rem;
  overflow: hidden;
  border: 1px solid rgba(0, 0, 0, 0.05);
  transition: all 0.3s ease;
}

.info-card:hover {
  box-shadow: 0 8px 30px rgba(0, 0, 0, 0.12);
  transform: translateY(-2px);
}

.card-header {
  background: linear-gradient(135deg, #f8f9fa, #e9ecef);
  padding: 1.25rem 1.5rem;
  border-bottom: 1px solid rgba(0, 0, 0, 0.08);
}

.card-header h5 {
  margin: 0;
  font-weight: 600;
  color: #495057;
  display: flex;
  align-items: center;
  gap: 0.75rem;
}

.card-header i {
  color: #6c757d;
}

.card-body {
  padding: 1.5rem;
}

/* Skills */
.skills-container {
  display: flex;
  flex-wrap: wrap;
  gap: 0.5rem;
}

.skill-tag {
  background: linear-gradient(135deg, #667eea, #764ba2);
  color: white;
  padding: 0.4rem 0.8rem;
  border-radius: 20px;
  font-size: 0.85rem;
  font-weight: 500;
  box-shadow: 0 2px 8px rgba(102, 126, 234, 0.3);
  transition: all 0.2s ease;
}

.skill-tag:hover {
  transform: translateY(-1px);
  box-shadow: 0 4px 12px rgba(102, 126, 234, 0.4);
}

/* Stats Grid */
.stats-grid {
  display: flex;
  flex-direction: column;
  gap: 1rem;
}

.stat-item {
  display: flex;
  align-items: center;
  gap: 1rem;
  padding: 0.75rem;
  background: #f8f9fa;
  border-radius: 12px;
  transition: all 0.2s ease;
}

.stat-item:hover {
  background: #e9ecef;
  transform: translateX(4px);
}

.stat-icon {
  width: 45px;
  height: 45px;
  border-radius: 12px;
  display: flex;
  align-items: center;
  justify-content: center;
  color: white;
  font-size: 1.1rem;
}

.company-size {
  background: linear-gradient(135deg, #667eea, #764ba2);
}

.industry {
  background: linear-gradient(135deg, #f093fb, #f5576c);
}

.stat-info {
  display: flex;
  flex-direction: column;
}

.stat-label {
  font-size: 0.8rem;
  color: #6c757d;
  text-transform: uppercase;
  letter-spacing: 0.5px;
}

.stat-value {
  font-weight: 600;
  color: #495057;
}

/* Professional Grid */
.professional-grid {
  display: flex;
  flex-direction: column;
  gap: 1.5rem;
  margin-bottom: 2rem;
}

.professional-item {
  display: flex;
  gap: 1rem;
  align-items: flex-start;
}

.item-icon {
  width: 50px;
  height: 50px;
  border-radius: 12px;
  display: flex;
  align-items: center;
  justify-content: center;
  color: white;
  font-size: 1.2rem;
  flex-shrink: 0;
}

.experience {
  background: linear-gradient(135deg, #667eea, #764ba2);
}

.education {
  background: linear-gradient(135deg, #4facfe, #00f2fe);
}

.resume {
  background: linear-gradient(135deg, #f093fb, #f5576c);
}

.item-content h6 {
  margin-bottom: 0.5rem;
  color: #495057;
  font-weight: 600;
}

.item-content p {
  margin: 0;
  color: #6c757d;
  line-height: 1.5;
}

/* Links and Actions */
.website-link {
  color: #667eea;
  text-decoration: none;
  font-weight: 500;
  display: inline-flex;
  align-items: center;
  gap: 0.5rem;
  transition: all 0.2s ease;
}

.website-link:hover {
  color: #764ba2;
  text-decoration: none;
  transform: translateX(4px);
}

.resume-download {
  background: linear-gradient(135deg, #f093fb, #f5576c);
  color: white;
  padding: 0.5rem 1rem;
  border-radius: 20px;
  text-decoration: none;
  display: inline-flex;
  align-items: center;
  gap: 0.5rem;
  font-size: 0.9rem;
  font-weight: 500;
  transition: all 0.3s ease;
  box-shadow: 0 4px 12px rgba(240, 147, 251, 0.3);
}

.resume-download:hover {
  text-decoration: none;
  color: white;
  transform: translateY(-2px);
  box-shadow: 0 6px 20px rgba(240, 147, 251, 0.4);
}

/* Action Buttons */
.action-buttons {
  display: flex;
  gap: 1rem;
  margin-top: 2rem;
  flex-wrap: wrap;
}

.action-buttons .btn {
  border-radius: 25px;
  padding: 0.6rem 1.5rem;
  font-weight: 600;
  transition: all 0.3s ease;
}

.action-buttons .btn:hover {
  transform: translateY(-2px);
  box-shadow: 0 6px 20px rgba(0, 0, 0, 0.15);
}

/* Company specific */
.company-description {
  margin-bottom: 1.5rem;
}

.company-description h6 {
  color: #495057;
  font-weight: 600;
  margin-bottom: 0.75rem;
}

.company-link {
  margin-bottom: 1.5rem;
}

.company-link h6 {
  color: #495057;
  font-weight: 600;
  margin-bottom: 0.75rem;
}

.bio-text {
  color: #6c757d;
  line-height: 1.6;
  margin: 0;
}

/* Responsive Design */
@media (max-width: 768px) {
  .hero-content {
    padding: 2rem 1.5rem;
  }
  
  .profile-name {
    font-size: 1.8rem;
  }
  
  .profile-meta {
    flex-direction: column;
    gap: 0.75rem;
  }
  
  .role-badge-wrapper {
    flex-direction: column;
    align-items: flex-start;
    gap: 0.75rem;
  }
  
  .profile-actions {
    margin-top: 1.5rem;
  }
  
  .action-buttons {
    flex-direction: column;
  }
  
  .professional-item {
    flex-direction: column;
    text-align: center;
  }
  
  .item-icon {
    align-self: center;
  }
}
</style>

{% endblock %}